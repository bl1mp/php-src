parameters:
  packages: ''

steps:
  - script: |
      /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
      # see https://formulae.brew.sh/ for package names
      brew install autoconf \
                   automake \
                   libtool \
                   mysql \
                   postgresql \
                   re2c \
                   pkg-config \
                   krb5 \
                   bzip2 \
                   enchant \
                   libffi \
                   libpng \
                   webp \
                   freetype \
                   intltool \
                   icu4c \
                   readline \
                   libiconv \
                   zlib \
                   t1lib \
                   gd \
                   libzip \
                   gmp \
                   tidyp
      brew link icu4c gettext --force
      brew services start mysql
      brew services start postgresql
      
      mkdir -p /usr/local/src/bison
      cd /usr/local/src/bison
      wget https://ftp.gnu.org/gnu/bison/bison-3.0.4.tar.gz
      tar xfv bison-3.0.4.tar.gz
      cd bison-3.0.4
      ./configure --disable-dependency-trackin --prefix=/usr/local/opt/bison304
      make
      sudo make install
    displayName: 'brew'
